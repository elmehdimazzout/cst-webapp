{% extends 'base.html' %}

{% block title %}Ø­Ø¯Ù {% endblock %}

{% block content %}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <h1>ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø¯Ù</h1>


    <div class="container mt-5">
        <div class="text-center m-3">

            <form method="POST">
                {% csrf_token %}
                <div class="buttons">
                    <button type="submit" class="delete-btn">ğŸ—‘ï¸ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</button>
                    <a href="{% url 'index' %}" class="cancel-btn">Ø¥Ù„ØºØ§Ø¡</a>
                </div>
            </form>
        
        </div>
        <div class="card">
            <div class="card-body">
                <h5 class="card-header  text-center">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù†Ø²ÙŠÙ„</h5>
                <table class="table  ">
                    <tbody>
                        <tr>
                            <th>Ø§Ù„Ø¥Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</th>
                            <td>{{ patient.nom_prenom }}</td>
                        </tr>
                        <tr>
                            <th>Ø±Ù‚Ù… Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙ</th>
                            <td>{{ patient.Cin }}</td>
                        </tr>
                        <tr>
                            <th>Ø§Ù„Ø¬Ù†Ø³</th>
                            <td>{{ patient.sexe }}</td>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©:</th>
                            <td>{{ patient.etat_matrimonial }}</td>
                        </tr>
                        <tr>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø²Ø¯ÙŠØ§Ø¯</th>
                            <td>{{ patient.date_naissance|date:"d/m/Y" }}</td>
                            <th>Ø§Ù„Ø³Ù†:</th>
                            <td>{{ patient.date_naissance|timesince }}</td>

                        </tr>
                        <tr>
                            <th>Ù…ÙƒØ§Ù† Ø§Ù„Ø¥Ø²Ø¯ÙŠØ§Ø¯</th>
                            <td>{{ patient.lieu_naissance }}</td>
                        </tr>
                        <tr>
                            <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                            <td>{{ patient.adresse }}</td>
                        </tr>
                    </tbody>
                </table>

                    <h5 class="card-header  text-center">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</h5>
                    <table class="table  ">
                        <tbody>
                            <tr>
                                <th>Ø¥Ø³Ù… Ø§Ù„Ø£Ø¨</th>
                                <td>{{ patient.nom_pere }}</td>
                                <th>Ø¥Ø³Ù… Ø§Ù„Ø£Ù…</th>
                                <td>{{ patient.nom_mere }}</td>
                            </tr>

                            <tr>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ø§ØªÙ</th>
                                <td>{{ patient.telephone }}</td>
                            </tr>
                        </tbody>
                    </table>

                    <h5 class="card-header  text-center">Ø§Ù„Ù…Ø¨ÙŠØª  </h5>
                    <table class="table  ">
                        <tbody>
                            <tr>
                                <th>Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø¨ÙŠØª </th>
                                <td>{{ patient.suite_couchage }}</td>
                                <th>Ø§Ù„ØºØ±ÙØ©  </th>
                                <td>{{ patient.chambre }}</td>
                            </tr>

                        </tbody>
                    </table>
                    <h5 class="card-header  text-center">Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© - Ø§Ù„ÙˆÙØ§Ø©  </h5>
                    <table class="table  ">
                        <tbody>
                            <tr>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯Ø®ÙˆÙ„ </th>
                                <td>{{ patient.date_entree|date:"d/m/Y" }}</td>
                                <th>Ø§Ù„Ù…ØµØ¯Ø±  </th>
                                <td>{{ patient.source_orientation }}</td>
                                <th>Ø³Ø¨Ø¨ ØªÙˆØ¬ÙŠÙ‡  </th>
                                <td>{{ patient.raison_direction }}</td>
                            </tr>
                            <tr>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© </th>
                                <td>{{ patient.date_entree|date:"d/m/Y" }}</td>
                                <th>Ø³Ø¨Ø¨ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©  </th>
                                <td>{{ patient.raison_depart }}</td>
                                <th>Ø§Ù„Ù…Ø±Ø§ÙÙ‚</th>
                                <td>{{ patient.son_compagnon }}</td>

                            </tr>
                            <tr>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙˆÙØ§Ø© </th>
                                <td>{{ patient.date_deces|date:"d/m/Y" }}</td>
                                <th>Ù…ÙƒØ§Ù† Ø§Ù„ÙˆÙØ§Ø©   </th>
                                <td>{{ patient.lieu_deces }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <h5 class="card-header  text-center">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©    </h5>
                    <table class="table table table-bordered ">
                        <thead>
                            <tr>                    
                              <th scope="col">Ù…Ø±Ø¶ Ù†ÙØ³ÙŠ </th>
                              <th scope="col">Ù…Ø±Ø¶ Ø§Ù„Ø³ÙƒØ±ÙŠ </th>
                              <th scope="col">Ø¶ØºØ· Ø§Ù„Ø¯Ù… 	</th>
                              <th scope="col">Ø§Ù„Ø³Ù„ 	</th>
                              <th scope="col">Ù…Ø±Ø¶ Ø§Ù„Ø³Ø±Ø·Ø§Ù† </th>
                            </tr>
                          </thead>
                        <tbody>
                            <tr>
                                <td>{{ patient.maladie_mentale }}</td>
                                <td>{{ patient.diabete }}</td>
                                <td>{{ patient.pression_arterielle }}</td>
                                <td>{{ patient.tuberculose }}</td>
                                <td>{{ patient.tumeurs }}</td>
                            </tr>

                        </tbody>
                    </table>
                    <h5 class="card-header  text-center">Ø¥Ø¹Ø§Ù‚Ø© Ø¬Ø³Ø¯ÙŠØ©   </h5>
                    <table class="table table table-bordered ">
                        <thead>
                            <tr>
                              <th scope="col">Ø¥Ø¹Ø§Ù‚Ø© Ø­Ø±ÙƒÙŠØ©</th>
                              <th scope="col">Ø£ØµÙ… ÙˆØ£Ø¨ÙƒÙ…	</th>
                              <th scope="col">Ø¶Ø¹Ù Ø§Ù„Ø¨ØµØ±	</th>
                              <th scope="col">Ø£Ø·Ø±Ø§Ù Ù…Ø¨ØªÙˆØ±Ø©</th>
                            </tr>
                          </thead>
                        <tbody>
                            <tr>
                                <td>{{ patient.handicap_moteur }}</td>
                                <td>{{ patient.sourd_muet }}</td>
                                <td>{{ patient.deficience_visuelle }}</td>
                                <td>{{ patient.membres_amputes }}</td>
                            </tr>

                        </tbody>
                    </table>
                    
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
        $(document).ready(function(){
            $(".delete-btn").click(function(event){
                event.preventDefault();  // âŒ Ù…Ù†Ø¹ Ø§Ù„Ø­Ø°Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                
                var patientId = $(this).data("id");
                var row = $("#patient-row-" + patientId);
    
                // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯
                Swal.fire({
                    title: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ",
                    text: "Ù„Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#d33",
                    cancelButtonColor: "#3085d6",
                    confirmButtonText: "Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù!",
                    cancelButtonText: "Ø¥Ù„ØºØ§Ø¡"
                }).then((result) => {
                    if (result.isConfirmed) {
                        // âœ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ø°Ù ÙÙ‚Ø· Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù†Ø¹Ù…"
                        $.ajax({
                            url: "/" + patientId + "/delete/",
                            type: "POST",
                            headers: { "X-CSRFToken": "{{ csrf_token }}" },
                            success: function(response) {
                                if(response.success) {
                                    row.fadeOut(500, function() { $(this).remove(); });
                                    Swal.fire("ØªÙ… Ø§Ù„Ø­Ø°Ù!", "ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø±ÙŠØ¶ Ø¨Ù†Ø¬Ø§Ø­.", "success");
                                }
                            },
                            error: function() {
                                Swal.fire("Ø®Ø·Ø£!", "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù!", "error");
                            }
                        });
                    }
                });
            });
        });
    </script>
    
        
    
{% endblock %}
